<!DOCTYPE html>
<html>

<head>
  <title>控制图层位置关系
  </title>
  <link rel="stylesheet" href="../include/ol.css" type="text/css">
  <script src="../include/ol.js"></script>
  <script src="../include/jquery-3.1.1.min.js"></script>

</head>
<style>
  #layertree li>span {
    cursor: pointer;
  }
</style>

<body>
  <div>
    <label for="idx1">
      <input type="number" id="idx1"></input>
      方块所在图层的 Z-index
    </label></br>

    <label for="idx2">
      <input type="number" id="idx2"></input>
      三角形所在图层的 Z-index
    </label>
  </div>

  <div id="map" class="map"></div>

  <script>
    // https://openlayers.org/en/latest/apidoc/module-ol_style_Stroke-Stroke.html
    var stroke = new ol.style.Stroke({ color: 'black', width: 1 }); //	Stroke描边样式。

    var styles = {
      //https://openlayers.org/en/latest/apidoc/module-ol_style_Style-Style.html
      'square': new ol.style.Style({
        //为矢量特征设置规则的形状样式。 https://openlayers.org/en/latest/apidoc/module-ol_style_RegularShape-RegularShape.html
        // 当radius提供时，结果形状将为规则多边形，而提供和时radius1， 结果形状将为星形radius2。
        image: new ol.style.RegularShape({
          fill: new ol.style.Fill({ color: 'blue' }), //填充样式。
          stroke: stroke, //描边样式。
          points: 4, //星形和规则多边形的点数。在多边形的情况下，点数是边数。
          radius: 80, //正多边形的半径。
          angle: Math.PI / 4  ////形状的角度（以弧度为单位）。值0将使形状的点之一朝上   //90度
        })
      }),
      'triangle': new ol.style.Style({
        image: new ol.style.RegularShape({
          fill: new ol.style.Fill({ color: 'red' }),
          stroke: stroke,
          points: 3,
          radius: 80,
          rotation: Math.PI / 4, //弧度旋转（顺时针正旋转）。
          angle: 0 //形状的角度（以弧度为单位）。值0将使形状的点之一朝上。
        })
      }),
      'star': new ol.style.Style({
        image: new ol.style.RegularShape({
          fill: new ol.style.Fill({ color: 'green' }),
          stroke: stroke,
          points: 5,
          radius: 80, //半径。
          radius2: 20, //星星的内半径。
          angle: 0
        })
      })
    };

     //封装创建图层的方法
    function createLayer(coordinates, style, zIndex) {
      var feature = new ol.Feature(new ol.geom.Point(coordinates));
      feature.setStyle(style);
     
      var source = new ol.source.Vector({
        features: [feature]
      });

      var vectorLayer = new ol.layer.Vector({
        source: source
      });
      vectorLayer.setZIndex(zIndex);

      return vectorLayer;
    }

    var layer0 = createLayer([40, 40], styles['star'], 0);
    var layer1 = createLayer([0, 0], styles['square'], 1);
    var layer2 = createLayer([0, 40], styles['triangle'], 0);

    var layers = [];
    layers.push(layer1);
    layers.push(layer2);
    layers.push(layer0);

    var map = new ol.Map({
      layers: layers,
      target: 'map',
      view: new ol.View({
        center: [0, 0],
        zoom: 18
      })
    });

   //input控件和回调函数进行绑定
    function bindInputs(id, layer) {
      var idxInput = document.getElementById('idx' + id);
      idxInput.onchange = function () {
        //https://openlayers.org/en/latest/apidoc/module-ol_layer_Layer-Layer.html#setZIndex
        layer.setZIndex(parseInt(this.value, 10) || 0);
        console.log( layer.setZIndex(parseInt(this.value, 10) || 0))

      };
      idxInput.value = String(layer.getZIndex()); //String() 函数把对象的值转换为字符串。
      // idxInput.value = layer.getZIndex();
      console.log(idxInput.value)

    }
    bindInputs(1, layer1);
    bindInputs(2, layer2);
  </script>
</body>

</html>